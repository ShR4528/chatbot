import requests
from urllib.parse import urlsplit
from urllib.parse import urljoin


target_url = "http://example.com"

# Проверка на наличие распространенных путей
for path in ['admin', 'login', 'wp-login', 'backup']:
    url = urlsplit.urljoin(target_url, path)
    res = requests.get(url)
    if res.status_code == 200:
        print("[+] Found potentially interesting path:", url)

# Перебор запросов с разными методами
for method in ['GET', 'POST', 'PUT', 'DELETE', 'OPTIONS']:
    res = requests.request(method, target_url)
    print(
        f"[+] Sent {method} request to {target_url}, got status code: {res.status_code}")

# Проверка заголовков на наличие опасныхHeader values
headers = {'User-Agent': 'HackerProbe'}
res = requests.get(target_url, headers=headers)
if 'X-XSS-Protection' not in res.headers:
    print("[-] X-XSS-Protection header missing")
